head	1.4;
access;
symbols
	cvs-200408041000:1.1.2.1 FSF:1.1.2;
locks; strict;
comment	@# @;


1.4
date	2004.10.16.23.25.47;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2004.08.04.10.45.27;	author tg;	state Stab;
branches;
next	1.2;

1.2
date	2004.08.04.10.33.07;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2004.08.04.10.06.25;	author tg;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2004.08.04.10.06.25;	author tg;	state Exp;
branches;
next	;


desc
@@


1.4
log
@reduce diff and assign to FSF
you gotta love F2+E in midnight commander ;)
@
text
@#! /bin/sh
# $MirBSD: contrib/gnu/automake/lib/missing,v 1.3 2004/08/04 10:45:27 tg Stab $
#
# Common stub for a few missing GNU programs while installing.

scriptversion=2003-09-02.23

# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003, 2004
#   Free Software Foundation, Inc.
# Originally by Fran,cois Pinard <pinard@@iro.umontreal.ca>, 1996.

# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2, or (at your option)
# any later version.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.

# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
# 02111-1307, USA.

# As a special exception to the GNU General Public License, if you
# distribute this file as part of a program that contains a
# configuration script generated by Autoconf, you may include it under
# the same distribution terms that you use for the rest of that program.

if test $# -eq 0; then
  echo 1>&2 "Try '$0 --help' for more information"
  exit 1
fi

run=:

# In the cases where this matters, 'missing' is being run in the
# srcdir already.
if test -f configure.ac; then
  configure_ac=configure.ac
else
  configure_ac=configure.in
fi

msg="missing on your system"

case "$1" in
--run)
  # Try to run requested program, and just exit if it succeeds.
  run=
  shift
  "$@@" && exit 0
  # Exit code 63 means version mismatch.  This often happens
  # when the user try to use an ancient version of a tool on
  # a file that requires a minimum version.  In this case we
  # we should proceed has if the program had been absent, or
  # if --run hadn't been passed.
  if test $? = 63; then
    run=:
    msg="probably too old"
  fi
  ;;
esac

# If it does not exist, or fails to run (possibly an outdated version),
# try to emulate it.
case "$1" in

  -h|--h|--he|--hel|--help)
    echo "\
$0 [OPTION]... PROGRAM [ARGUMENT]...

Handle 'PROGRAM [ARGUMENT]...' for when PROGRAM is missing, or return an
error status if there is no known handling for PROGRAM.

Options:
  -h, --help      display this help and exit
  -v, --version   output version information and exit
  --run           try to run the given command, and emulate it if it fails

Supported PROGRAM values:
  aclocal      touch file 'aclocal.m4'
  autoconf     touch file 'configure'
  autoheader   touch file 'config.h.in'
  automake     touch all 'Makefile.in' files
  bison        create 'y.tab.[ch]', if possible, from existing .[ch]
  flex         create 'lex.yy.c', if possible, from existing .c
  help2man     touch the output file
  lex          create 'lex.yy.c', if possible, from existing .c
  makeinfo     touch the output file
  tar          try tar, gnutar, gtar, then tar without non-portable flags
  yacc         create 'y.tab.[ch]', if possible, from existing .[ch]

Send bug reports to <bug-automake@@gnu.org>."
    ;;

  -v|--v|--ve|--ver|--vers|--versi|--versio|--version)
    echo "missing $scriptversion (GNU Automake)"
    ;;

  -*)
    echo 1>&2 "$0: Unknown '$1' option"
    echo 1>&2 "Try '$0 --help' for more information"
    exit 1
    ;;

  aclocal*)
    if test -z "$run" && ($1 --version) >/dev/null 2>&1; then
       # We have it, but it failed.
       exit 1
    fi

    echo 1>&2 "\
WARNING: '$1' is $msg.  You should only need it if
         you modified 'acinclude.m4' or '${configure_ac}'.  You might want
         to install the 'Automake' and 'Perl' packages.  Grab them from
         any GNU archive site."
    touch aclocal.m4
    ;;

  autoconf)
    if test -z "$run" && ($1 --version) >/dev/null 2>&1; then
       # We have it, but it failed.
       exit 1
    fi

    echo 1>&2 "\
WARNING: '$1' is $msg.  You should only need it if
         you modified '${configure_ac}'.  You might want to install the
         'Autoconf' and 'GNU m4' packages.  Grab them from any GNU
         archive site."
    touch configure
    ;;

  autoheader)
    if test -z "$run" && ($1 --version) >/dev/null 2>&1; then
       # We have it, but it failed.
       exit 1
    fi

    echo 1>&2 "\
WARNING: '$1' is $msg.  You should only need it if
         you modified 'acconfig.h' or '${configure_ac}'.  You might want
         to install the 'Autoconf' and 'GNU m4' packages.  Grab them
         from any GNU archive site."
    files=$(sed -n 's/^[ ]*A[CM]_CONFIG_HEADER(\([^)]*\)).*/\1/p' ${configure_ac})
    test -z "$files" && files="config.h"
    touch_files=
    for f in $files; do
      case "$f" in
      *:*) touch_files="$touch_files "$(echo "$f" |
				       sed -e 's/^[^:]*://' -e 's/:.*//');;
      *) touch_files="$touch_files $f.in";;
      esac
    done
    touch $touch_files
    ;;

  automake*)
    if test -z "$run" && ($1 --version) >/dev/null 2>&1; then
       # We have it, but it failed.
       exit 1
    fi

    echo 1>&2 "\
WARNING: '$1' is $msg.  You should only need it if
         you modified 'Makefile.am', 'acinclude.m4' or '${configure_ac}'.
         You might want to install the 'Automake' and 'Perl' packages.
         Grab them from any GNU archive site."
    find . -type f -name Makefile.am -print |
	   sed 's/\.am$/.in/' |
	   while read f; do touch "$f"; done
    ;;

  autom4te)
    if test -z "$run" && ($1 --version) >/dev/null 2>&1; then
       # We have it, but it failed.
       exit 1
    fi

    echo 1>&2 "\
WARNING: '$1' is needed, but is $msg.
         You might have modified some files without having the
         proper tools for further handling them.
         You can get '$1' as part of 'Autoconf' from any GNU
         archive site."

    file=$(echo "$*" | sed -n 's/.*--output[ =]*\([^ ]*\).*/\1/p')
    test -z "$file" && file=$(echo "$*" | sed -n 's/.*-o[ ]*\([^ ]*\).*/\1/p')
    if test -f "$file"; then
	touch $file
    else
	test -z "$file" || exec >$file
	echo "#! /bin/sh"
	echo "# Created by GNU Automake missing as a replacement of"
	echo "#  $ $@@"
	echo "exit 0"
	chmod +x $file
	exit 1
    fi
    ;;

  bison|yacc)
    echo 1>&2 "\
WARNING: '$1' $msg.  You should only need it if
         you modified a '.y' file.  You may need the 'Bison' package
         in order for those modifications to take effect.  You can get
         'Bison' from any GNU archive site."
    rm -f y.tab.c y.tab.h
    if [ $# -ne 1 ]; then
        eval LASTARG="\${$#}"
	case "$LASTARG" in
	*.y)
	    SRCFILE=$(echo "$LASTARG" | sed 's/y$/c/')
	    if [ -f "$SRCFILE" ]; then
	         cp "$SRCFILE" y.tab.c
	    fi
	    SRCFILE=$(echo "$LASTARG" | sed 's/y$/h/')
	    if [ -f "$SRCFILE" ]; then
	         cp "$SRCFILE" y.tab.h
	    fi
	  ;;
	esac
    fi
    if [ ! -f y.tab.h ]; then
	echo >y.tab.h
    fi
    if [ ! -f y.tab.c ]; then
	echo 'main() { return 0; }' >y.tab.c
    fi
    ;;

  lex|flex)
    echo 1>&2 "\
WARNING: '$1' is $msg.  You should only need it if
         you modified a '.l' file.  You may need the 'Flex' package
         in order for those modifications to take effect.  You can get
         'Flex' from any GNU archive site."
    rm -f lex.yy.c
    if [ $# -ne 1 ]; then
        eval LASTARG="\${$#}"
	case "$LASTARG" in
	*.l)
	    SRCFILE=$(echo "$LASTARG" | sed 's/l$/c/')
	    if [ -f "$SRCFILE" ]; then
	         cp "$SRCFILE" lex.yy.c
	    fi
	  ;;
	esac
    fi
    if [ ! -f lex.yy.c ]; then
	echo 'main() { return 0; }' >lex.yy.c
    fi
    ;;

  help2man)
    if test -z "$run" && ($1 --version) >/dev/null 2>&1; then
       # We have it, but it failed.
       exit 1
    fi

    echo 1>&2 "\
WARNING: '$1' is $msg.  You should only need it if
	 you modified a dependency of a manual page.  You may need the
	 'Help2man' package in order for those modifications to take
	 effect.  You can get 'Help2man' from any GNU archive site."

    file=$(echo "$*" | sed -n 's/.*-o \([^ ]*\).*/\1/p')
    if test -z "$file"; then
	file=$(echo "$*" | sed -n 's/.*--output=\([^ ]*\).*/\1/p')
    fi
    if [ -f "$file" ]; then
	touch $file
    else
	test -z "$file" || exec >$file
	echo ".ab help2man is required to generate this page"
	exit 1
    fi
    ;;

  makeinfo)
    if test -z "$run" && (makeinfo --version) >/dev/null 2>&1; then
       # We have makeinfo, but it failed.
       exit 1
    fi

    echo 1>&2 "\
WARNING: '$1' is $msg.  You should only need it if
         you modified a '.texi' or '.texinfo' file, or any other file
         indirectly affecting the aspect of the manual.  The spurious
         call might also be the consequence of using a buggy 'make' (AIX,
         DU, IRIX).  You might want to install the 'Texinfo' package or
         the 'GNU make' package.  Grab either from any GNU archive site."
    file=$(echo "$*" | sed -n 's/.*-o \([^ ]*\).*/\1/p')
    if test -z "$file"; then
      file=$(echo "$*" | sed 's/.* \([^ ]*\) *$/\1/')
      file=$(sed -n '/^@@setfilename/ { s/.* \([^ ]*\) *$/\1/; p; q; }' $file)
    fi
    touch $file
    ;;

  tar)
    shift
    if test -n "$run"; then
      echo 1>&2 "ERROR: 'tar' requires --run"
      exit 1
    fi

    # We have already tried tar in the generic part.
    # Look for gnutar/gtar before invocation to avoid ugly error
    # messages.
    if (gnutar --version >/dev/null 2>&1); then
       gnutar "$@@" && exit 0
    fi
    if (gtar --version >/dev/null 2>&1); then
       gtar "$@@" && exit 0
    fi
    firstarg="$1"
    if shift; then
	case "$firstarg" in
	*o*)
	    firstarg=$(echo "$firstarg" | sed s/o//)
	    tar "$firstarg" "$@@" && exit 0
	    ;;
	esac
	case "$firstarg" in
	*h*)
	    firstarg=$(echo "$firstarg" | sed s/h//)
	    tar "$firstarg" "$@@" && exit 0
	    ;;
	esac
    fi

    echo 1>&2 "\
WARNING: I can't seem to be able to run 'tar' with the given arguments.
         You may want to install GNU tar or Free paxutils, or check the
         command line arguments."
    exit 1
    ;;

  *)
    echo 1>&2 "\
WARNING: '$1' is needed, and is $msg.
         You might have modified some files without having the
         proper tools for further handling them.  Check the 'README' file,
         it often tells you about the needed prerequisites for installing
         this package.  You may also peek at any GNU archive site, in case
         some other package would contain this missing '$1' program."
    exit 1
    ;;
esac

exit 0

# Local variables:
# eval: (add-hook 'write-file-hooks 'time-stamp)
# time-stamp-start: "scriptversion="
# time-stamp-format: "%:y-%02m-%02d.%02H"
# time-stamp-end: "$"
# End:
@


1.3
log
@apply old diffs to new automake-based files
switch depcomp and missing to automake-based
@
text
@d2 1
a2 1
# $MirBSD: contrib/gnu/automake/lib/missing,v 1.2 2004/08/04 10:33:07 tg Exp $
d8 1
a8 1
# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003
d14 2
a15 1
# the Free Software Foundation; version 2.
@


1.2
log
@add RCS IDs and mop up whitespace (surprisingly few at EOL)
@
text
@d2 1
a2 1
# $MirBSD$
d14 1
a14 2
# the Free Software Foundation; either version 2, or (at your option)
# any later version.
d32 1
a32 1
  echo 1>&2 "Try \`$0 --help' for more information"
d38 1
a38 1
# In the cases where this matters, `missing' is being run in the
d74 1
a74 1
Handle \`PROGRAM [ARGUMENT]...' for when PROGRAM is missing, or return an
d83 6
a88 6
  aclocal      touch file \`aclocal.m4'
  autoconf     touch file \`configure'
  autoheader   touch file \`config.h.in'
  automake     touch all \`Makefile.in' files
  bison        create \`y.tab.[ch]', if possible, from existing .[ch]
  flex         create \`lex.yy.c', if possible, from existing .c
d90 1
a90 1
  lex          create \`lex.yy.c', if possible, from existing .c
d93 1
a93 1
  yacc         create \`y.tab.[ch]', if possible, from existing .[ch]
d103 2
a104 2
    echo 1>&2 "$0: Unknown \`$1' option"
    echo 1>&2 "Try \`$0 --help' for more information"
d109 1
a109 1
    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
d115 3
a117 3
WARNING: \`$1' is $msg.  You should only need it if
         you modified \`acinclude.m4' or \`${configure_ac}'.  You might want
         to install the \`Automake' and \`Perl' packages.  Grab them from
d123 1
a123 1
    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
d129 3
a131 3
WARNING: \`$1' is $msg.  You should only need it if
         you modified \`${configure_ac}'.  You might want to install the
         \`Autoconf' and \`GNU m4' packages.  Grab them from any GNU
d137 1
a137 1
    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
d143 3
a145 3
WARNING: \`$1' is $msg.  You should only need it if
         you modified \`acconfig.h' or \`${configure_ac}'.  You might want
         to install the \`Autoconf' and \`GNU m4' packages.  Grab them
d147 1
a147 1
    files=`sed -n 's/^[ ]*A[CM]_CONFIG_HEADER(\([^)]*\)).*/\1/p' ${configure_ac}`
d152 2
a153 2
      *:*) touch_files="$touch_files "`echo "$f" |
				       sed -e 's/^[^:]*://' -e 's/:.*//'`;;
d161 1
a161 1
    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
d167 3
a169 3
WARNING: \`$1' is $msg.  You should only need it if
         you modified \`Makefile.am', \`acinclude.m4' or \`${configure_ac}'.
         You might want to install the \`Automake' and \`Perl' packages.
d177 1
a177 1
    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
d183 1
a183 1
WARNING: \`$1' is needed, but is $msg.
d186 1
a186 1
         You can get \`$1' as part of \`Autoconf' from any GNU
d189 2
a190 2
    file=`echo "$*" | sed -n 's/.*--output[ =]*\([^ ]*\).*/\1/p'`
    test -z "$file" && file=`echo "$*" | sed -n 's/.*-o[ ]*\([^ ]*\).*/\1/p'`
d206 2
a207 2
WARNING: \`$1' $msg.  You should only need it if
         you modified a \`.y' file.  You may need the \`Bison' package
d209 1
a209 1
         \`Bison' from any GNU archive site."
d215 1
a215 1
	    SRCFILE=`echo "$LASTARG" | sed 's/y$/c/'`
d219 1
a219 1
	    SRCFILE=`echo "$LASTARG" | sed 's/y$/h/'`
d236 2
a237 2
WARNING: \`$1' is $msg.  You should only need it if
         you modified a \`.l' file.  You may need the \`Flex' package
d239 1
a239 1
         \`Flex' from any GNU archive site."
d245 1
a245 1
	    SRCFILE=`echo "$LASTARG" | sed 's/l$/c/'`
d258 1
a258 1
    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
d264 1
a264 1
WARNING: \`$1' is $msg.  You should only need it if
d266 2
a267 2
	 \`Help2man' package in order for those modifications to take
	 effect.  You can get \`Help2man' from any GNU archive site."
d269 1
a269 1
    file=`echo "$*" | sed -n 's/.*-o \([^ ]*\).*/\1/p'`
d271 1
a271 1
	file=`echo "$*" | sed -n 's/.*--output=\([^ ]*\).*/\1/p'`
d283 1
a283 1
    if test -z "$run" && (makeinfo --version) > /dev/null 2>&1; then
d289 2
a290 2
WARNING: \`$1' is $msg.  You should only need it if
         you modified a \`.texi' or \`.texinfo' file, or any other file
d292 4
a295 4
         call might also be the consequence of using a buggy \`make' (AIX,
         DU, IRIX).  You might want to install the \`Texinfo' package or
         the \`GNU make' package.  Grab either from any GNU archive site."
    file=`echo "$*" | sed -n 's/.*-o \([^ ]*\).*/\1/p'`
d297 2
a298 2
      file=`echo "$*" | sed 's/.* \([^ ]*\) *$/\1/'`
      file=`sed -n '/^@@setfilename/ { s/.* \([^ ]*\) *$/\1/; p; q; }' $file`
d306 1
a306 1
      echo 1>&2 "ERROR: \`tar' requires --run"
d313 1
a313 1
    if (gnutar --version > /dev/null 2>&1); then
d316 1
a316 1
    if (gtar --version > /dev/null 2>&1); then
d323 1
a323 1
	    firstarg=`echo "$firstarg" | sed s/o//`
d329 1
a329 1
	    firstarg=`echo "$firstarg" | sed s/h//`
d336 1
a336 1
WARNING: I can't seem to be able to run \`tar' with the given arguments.
d344 1
a344 1
WARNING: \`$1' is needed, and is $msg.
d346 1
a346 1
         proper tools for further handling them.  Check the \`README' file,
d349 1
a349 1
         some other package would contain this missing \`$1' program."
@


1.1
log
@Initial revision
@
text
@d2 2
d8 1
a8 1
# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003 
@


1.1.2.1
log
@GNU automake CVS-current from anoncvs@@subversions.gnu.org:/cvsroot/automake
@
text
@@
