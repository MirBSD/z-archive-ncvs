head	2.1;
access;
symbols
	cvs-200501160850:1.1.1.1
	start:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


2.1
date	2005.01.03.16.41.21;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2004.12.12.21.35.03;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2004.12.12.21.35.03;	author tg;	state Exp;
branches;
next	;


desc
@@


2.1
log
@work over most of the changes MirOS has done, and add
the new or copied/moved files
@
text
@# Build wrapper for the HTTP daemon
# $MirBSD: src/usr.sbin/httpd/Makefile.bsd-wrapper,v 1.28 2004/12/12 18:02:32 tg Exp $
# $OpenBSD: Makefile.bsd-wrapper,v 1.47 2004/06/07 04:17:13 brad Exp $

.include <bsd.own.mk>

#   MirOS Layout
#<Layout MirOS>
#    prefix:        /var/www
#    exec_prefix:   /usr
#    bindir:        $exec_prefix/bin
#    sbindir:       $exec_prefix/sbin
#    libexecdir:    $exec_prefix/libexec/httpd/modules
#    mandir:        $exec_prefix/share/man
#    sysconfdir:    $prefix/conf
#    datadir:       $prefix
#    iconsdir:      $prefix/icons
#    htdocsdir:     $prefix/htdocs
#    manualdir:     $htdocsdir/manual
#    cgidir:        $prefix/cgi-bin
#    includedir:    $exec_prefix/libexec/httpd/include
#    localstatedir: $prefix
#    runtimedir:    $prefix/logs
#    logfiledir:    $prefix/logs
#    proxycachedir: $prefix/proxy
#</Layout>

HTTPD_PREFIX=		/var/www
HTTPD_EXEC_PREFIX=	/usr
HTTPD_BINDIR=		${HTTPD_EXEC_PREFIX}/bin
HTTPD_SBINDIR=		${HTTPD_EXEC_PREFIX}/sbin
HTTPD_LIBEXECDIR=	${HTTPD_EXEC_PREFIX}/libexec/httpd/modules
HTTPD_SYSCONFDIR=	${HTTPD_PREFIX}/conf
HTTPD_ICONSDIR=		${HTTPD_PREFIX}/icons
HTTPD_HTDOCSDIR=	${HTTPD_PREFIX}/htdocs
HTTPD_INCLUDEDIR=	${HTTPD_EXEC_PREFIX}/libexec/httpd/include
HTTPD_RUNDIR=		${HTTPD_PREFIX}/logs
HTTPD_LOGDIR=		${HTTPD_PREFIX}/logs

CONFIG_ARGS=	--with-layout="MirOS" --enable-module="ssl" --enable-suexec \
		--enable-module="keynote" --enable-rule=INET6 \
		--suexec-caller="www" --enable-rule=EXPAT \
		--suexec-docroot="${HTTPD_HTDOCSDIR}" --suexec-userdir="pub" \
		--suexec-logfile="/var/log/suexec_log" \
		--suexec-uidmin="1000" --suexec-gidmin="1000" \
		--suexec-safepath="/usr/bin:/bin:/usr/local/bin"

# This is stupid - to build a DSO module for httpd you not only need to
# --enable-shared, you need to --enable-module or --enable-shared doesn't
# do anything.

DSO_MODULE_ARGS=  \
	--enable-module=so \
	--enable-module=auth_anon \
	--enable-shared=auth_anon \
	--enable-module=expires \
	--enable-shared=expires \
	--enable-module=headers \
	--enable-shared=headers \
	--enable-module=auth_db \
	--enable-shared=auth_db \
	--enable-module=auth_dbm \
	--enable-shared=auth_dbm \
	--enable-module=auth_digest \
	--enable-shared=auth_digest \
	--enable-module=cern_meta \
	--enable-shared=cern_meta \
	--enable-module=define \
	--enable-shared=define \
	--enable-module=digest \
	--enable-shared=digest \
	--enable-module=info \
	--enable-shared=info \
	--enable-module=log_agent \
	--enable-shared=log_agent \
	--enable-module=log_referer \
	--enable-shared=log_referer \
	--enable-module=mime_magic \
	--enable-shared=mime_magic \
	--enable-module=mmap_static \
	--enable-shared=mmap_static \
	--enable-module=proxy \
	--enable-shared=proxy \
	--enable-module=rewrite \
	--enable-shared=rewrite \
	--enable-module=speling \
	--enable-shared=speling \
	--enable-module=unique_id \
	--enable-shared=unique_id \
	--enable-module=usertrack \
	--enable-shared=usertrack \
	--enable-module=vhost_alias \
	--enable-shared=vhost_alias

INSTALL_MODULES=

# If you support dynamic loading, enable the so module, and build all the
# modules that come with httpd.

.if !defined(NOPIC) || ${NOPIC:L} == "no"
CONFIG_ARGS+=  ${DSO_MODULE_ARGS}
INSTALL_MODULES= \
	src/modules/experimental/mod_mmap_static.so \
	src/modules/experimental/mod_auth_digest.so \
	src/modules/extra/mod_define.so \
	src/modules/proxy/libproxy.so \
	src/modules/standard/mod_vhost_alias.so \
	src/modules/standard/mod_log_agent.so \
	src/modules/standard/mod_info.so \
	src/modules/standard/mod_log_referer.so \
	src/modules/standard/mod_mime_magic.so \
	src/modules/standard/mod_speling.so \
	src/modules/standard/mod_rewrite.so \
	src/modules/standard/mod_auth_dbm.so \
	src/modules/standard/mod_auth_anon.so \
	src/modules/standard/mod_auth_db.so \
	src/modules/standard/mod_digest.so \
	src/modules/standard/mod_cern_meta.so \
	src/modules/standard/mod_usertrack.so \
	src/modules/standard/mod_unique_id.so \
	src/modules/standard/mod_expires.so \
	src/modules/standard/mod_headers.so
.endif

PERLPATH=	/usr/bin/perl

MUNGEDFILES=	${.OBJDIR}/src/ap/Makefile \
		${.OBJDIR}/src/include/ap_config_auto.h \
		${.OBJDIR}/src/main/Makefile \
		${.OBJDIR}/src/modules/experimental/Makefile \
		${.OBJDIR}/src/modules/extra/Makefile \
		${.OBJDIR}/src/modules/proxy/Makefile \
		${.OBJDIR}/src/modules/standard/Makefile \
		${.OBJDIR}/src/modules/keynote/Makefile \
		${.OBJDIR}/src/modules/ssl/Makefile \
		${.OBJDIR}/src/modules/ssl/ssl_expr_parse.c \
		${.OBJDIR}/src/modules/ssl/ssl_expr_parse.h \
		${.OBJDIR}/src/modules/ssl/ssl_expr_scan.c \
		${.OBJDIR}/src/modules/Makefile \
		${.OBJDIR}/src/os/unix/Makefile \
		${.OBJDIR}/src/regex/Makefile \
		${.OBJDIR}/src/support/Makefile \
		${.OBJDIR}/src/apaci \
		${.OBJDIR}/src/Makefile \
		${.OBJDIR}/src/Makefile.config \
		${.OBJDIR}/src/modules.c \
		${.OBJDIR}/src/Configuration.apaci \
		${.OBJDIR}/Makefile \
		${.OBJDIR}/config.status

BINFILES= 	src/support/htdigest src/support/htpasswd

SBINFILES= \
	src/httpd \
	src/support/logresolve src/support/rotatelogs src/support/suexec

MAN+=	httpd.8 src/support/apxs.8 src/support/dbmmanage.1 \
	src/support/htdigest.1 src/support/htpasswd.1 src/support/suexec.8 \
	src/support/logresolve.8 src/support/rotatelogs.8

INCFILES= \
	src/include/ap.h \
	src/include/ap_alloc.h  \
	src/include/ap_compat.h \
	src/include/ap_config.h \
	src/include/ap_config_auto.h \
	src/include/ap_ctx.h \
	src/include/ap_ctype.h \
	src/include/ap_hook.h \
	src/include/ap_md5.h \
	src/include/ap_mm.h \
	src/include/ap_mmn.h \
	src/include/ap_sha1.h \
	src/include/buff.h \
	src/include/compat.h \
	src/include/conf.h \
	src/include/explain.h \
	src/include/fnmatch.h \
	src/include/fdcache.h \
	src/include/hsregex.h \
	src/include/http_conf_globals.h \
	src/include/http_config.h \
	src/include/http_core.h \
	src/include/http_log.h \
	src/include/http_main.h \
	src/include/http_protocol.h \
	src/include/http_request.h \
	src/include/http_vhost.h \
	src/include/httpd.h \
	src/include/multithread.h \
	src/include/rfc1413.h \
	src/include/scoreboard.h \
	src/include/util_date.h \
	src/include/util_md5.h \
	src/include/util_script.h \
	src/include/util_uri.h \
	src/os/unix/os-inline.c \
	src/os/unix/os.h \
	src/include/sa_len.h \
	src/include/sockaddr_storage.h \
	src/modules/ssl/mod_ssl.h \
	src/modules/ssl/ssl_expr.h \
	src/modules/ssl/ssl_util_ssl.h \
	src/modules/ssl/ssl_util_table.h

CONFFILES= \
	conf/httpd.conf \
	conf/magic \
	conf/mime.types

HTDOCS=	\
	htdocs/index.htm

CGIFILES= \
	cgi-bin/printenv \
	cgi-bin/test-cgi

MANUALFILES= \
	manual/bind.html.en \
	manual/bind.html.fr \
	manual/bind.html.ja.jis \
	manual/configuring.html.en \
	manual/configuring.html.fr \
	manual/configuring.html.ja.jis \
	manual/content-negotiation.html.en \
	manual/content-negotiation.html.ja.jis \
	manual/custom-error.html.en \
	manual/custom-error.html.fr \
	manual/custom-error.html.ja.jis \
	manual/dns-caveats.html.en \
	manual/dns-caveats.html.fr \
	manual/dns-caveats.html.ja.jis \
	manual/dso.html \
	manual/env.html.en \
	manual/env.html.ja.jis \
	manual/handler.html.en \
	manual/handler.html.ja.jis \
	manual/howto/auth.html \
	manual/howto/cgi.html.en \
	manual/howto/cgi.html.ja.jis \
	manual/howto/htaccess.html \
	manual/howto/ssi.html.en \
	manual/howto/ssi.html.ja.jis \
	manual/images/custom_errordocs.gif \
	manual/images/feather.jpg \
	manual/images/home.gif \
	manual/images/index.gif \
	manual/images/mod_rewrite_fig1.fig \
	manual/images/mod_rewrite_fig1.gif \
	manual/images/mod_rewrite_fig2.fig \
	manual/images/mod_rewrite_fig2.gif \
	manual/images/mod_ssl_sb.gif \
	manual/images/openssl_ics.gif \
	manual/images/pixel.gif \
	manual/images/sub.gif \
	manual/index.html.en \
	manual/index.html.fr \
	manual/index.html.ja.jis \
	manual/invoking.html.en \
	manual/invoking.html.fr \
	manual/invoking.html.ja.jis \
	manual/keepalive.html.en \
	manual/keepalive.html.ja.jis \
	manual/location.html.en \
	manual/location.html.ja.jis \
	manual/logs.html \
	manual/misc/API.html \
	manual/misc/HTTP_Features.tsv \
	manual/misc/client_block_api.html \
	manual/misc/compat_notes.html \
	manual/misc/custom_errordocs.html \
	manual/misc/descriptors.html \
	manual/misc/fin_wait_2.html \
	manual/misc/howto.html \
	manual/misc/index.html \
	manual/misc/known_client_problems.html \
	manual/misc/perf-bsd44.html \
	manual/misc/perf-tuning.html \
	manual/misc/perf.html \
	manual/misc/rewriteguide.html \
	manual/misc/security_tips.html \
	manual/misc/tutorials.html \
	manual/mod/core.html.en \
	manual/mod/core.html.fr \
	manual/mod/core.html.ja.jis \
	manual/mod/directive-dict.html.en \
	manual/mod/directive-dict.html.fr \
	manual/mod/directive-dict.html.ja.jis \
	manual/mod/directives.html.de \
	manual/mod/directives.html.en \
	manual/mod/directives.html.fr \
	manual/mod/directives.html.ja.jis \
	manual/mod/index-bytype.html.en \
	manual/mod/index-bytype.html.fr \
	manual/mod/index-bytype.html.ja.jis \
	manual/mod/index.html.en \
	manual/mod/index.html.fr \
	manual/mod/index.html.ja.jis \
	manual/mod/mod_access.html.en \
	manual/mod/mod_access.html.ja.jis \
	manual/mod/mod_actions.html.en \
	manual/mod/mod_actions.html.ja.jis \
	manual/mod/mod_alias.html.en \
	manual/mod/mod_alias.html.ja.jis \
	manual/mod/mod_asis.html.en \
	manual/mod/mod_asis.html.ja.jis \
	manual/mod/mod_auth.html.en \
	manual/mod/mod_auth.html.ja.jis \
	manual/mod/mod_auth_anon.html \
	manual/mod/mod_auth_db.html \
	manual/mod/mod_auth_dbm.html \
	manual/mod/mod_auth_digest.html \
	manual/mod/mod_autoindex.html.en \
	manual/mod/mod_autoindex.html.ja.jis \
	manual/mod/mod_browser.html \
	manual/mod/mod_cern_meta.html \
	manual/mod/mod_cgi.html.en \
	manual/mod/mod_cgi.html.ja.jis \
	manual/mod/mod_cookies.html \
	manual/mod/mod_define.html \
	manual/mod/mod_digest.html \
	manual/mod/mod_dir.html.en \
	manual/mod/mod_dir.html.ja.jis \
	manual/mod/mod_dld.html \
	manual/mod/mod_env.html.en \
	manual/mod/mod_env.html.ja.jis \
	manual/mod/mod_example.html \
	manual/mod/mod_expires.html \
	manual/mod/mod_headers.html \
	manual/mod/mod_imap.html \
	manual/mod/mod_include.html \
	manual/mod/mod_info.html.en \
	manual/mod/mod_info.html.ja.jis \
	manual/mod/mod_isapi.html \
	manual/mod/mod_log_agent.html \
	manual/mod/mod_log_common.html \
	manual/mod/mod_log_config.html.en \
	manual/mod/mod_log_config.html.ja.jis \
	manual/mod/mod_log_referer.html \
	manual/mod/mod_mime.html.en \
	manual/mod/mod_mime.html.ja.jis \
	manual/mod/mod_mime_magic.html \
	manual/mod/mod_mmap_static.html \
	manual/mod/mod_negotiation.html.en \
	manual/mod/mod_negotiation.html.ja.jis \
	manual/mod/mod_proxy.html \
	manual/mod/mod_rewrite.html.en \
	manual/mod/mod_rewrite.html.ja.jis \
	manual/mod/mod_setenvif.html.en \
	manual/mod/mod_setenvif.html.ja.jis \
	manual/mod/mod_so.html.en \
	manual/mod/mod_so.html.ja.jis \
	manual/mod/mod_speling.html.en \
	manual/mod/mod_speling.html.ja.jis \
	manual/mod/mod_ssl/index.html \
	manual/mod/mod_ssl/ssl_compat.gfont000.gif \
	manual/mod/mod_ssl/ssl_compat.html \
	manual/mod/mod_ssl/ssl_compat.wml \
	manual/mod/mod_ssl/ssl_cover.wml \
	manual/mod/mod_ssl/ssl_cover_logo.jpg \
	manual/mod/mod_ssl/ssl_cover_title.jpg \
	manual/mod/mod_ssl/ssl_faq.gfont000.gif \
	manual/mod/mod_ssl/ssl_faq.html \
	manual/mod/mod_ssl/ssl_faq.wml \
	manual/mod/mod_ssl/ssl_glossary.html \
	manual/mod/mod_ssl/ssl_glossary.wml \
	manual/mod/mod_ssl/ssl_howto.gfont000.gif \
	manual/mod/mod_ssl/ssl_howto.html \
	manual/mod/mod_ssl/ssl_howto.wml \
	manual/mod/mod_ssl/ssl_intro.gfont000.gif \
	manual/mod/mod_ssl/ssl_intro.html \
	manual/mod/mod_ssl/ssl_intro.wml \
	manual/mod/mod_ssl/ssl_intro_fig1.gif \
	manual/mod/mod_ssl/ssl_intro_fig2.gif \
	manual/mod/mod_ssl/ssl_intro_fig3.gif \
	manual/mod/mod_ssl/ssl_overview.gfont000.gif \
	manual/mod/mod_ssl/ssl_overview.html \
	manual/mod/mod_ssl/ssl_overview.wml \
	manual/mod/mod_ssl/ssl_overview_fig1.gif \
	manual/mod/mod_ssl/ssl_reference.gfont000.gif \
	manual/mod/mod_ssl/ssl_reference.html \
	manual/mod/mod_ssl/ssl_reference.wml \
	manual/mod/mod_ssl/ssl_template.head-chapter.gif \
	manual/mod/mod_ssl/ssl_template.head-num-1.gif \
	manual/mod/mod_ssl/ssl_template.head-num-2.gif \
	manual/mod/mod_ssl/ssl_template.head-num-3.gif \
	manual/mod/mod_ssl/ssl_template.head-num-4.gif \
	manual/mod/mod_ssl/ssl_template.head-num-5.gif \
	manual/mod/mod_ssl/ssl_template.head-num-6.gif \
	manual/mod/mod_ssl/ssl_template.head-num-7.gif \
	manual/mod/mod_ssl/ssl_template.imgdot-1x1-000000.gif \
	manual/mod/mod_ssl/ssl_template.imgdot-1x1-transp.gif \
	manual/mod/mod_ssl/ssl_template.inc \
	manual/mod/mod_ssl/ssl_template.navbut-next-n.gif \
	manual/mod/mod_ssl/ssl_template.navbut-next-s.gif \
	manual/mod/mod_ssl/ssl_template.navbut-prev-n.gif \
	manual/mod/mod_ssl/ssl_template.navbut-prev-s.gif \
	manual/mod/mod_ssl/ssl_template.title-abstract.gif \
	manual/mod/mod_ssl/ssl_template.title-compat.gif \
	manual/mod/mod_ssl/ssl_template.title-faq.gif \
	manual/mod/mod_ssl/ssl_template.title-gloss.gif \
	manual/mod/mod_ssl/ssl_template.title-howto.gif \
	manual/mod/mod_ssl/ssl_template.title-intro.gif \
	manual/mod/mod_ssl/ssl_template.title-over.gif \
	manual/mod/mod_ssl/ssl_template.title-preface.gif \
	manual/mod/mod_ssl/ssl_template.title-ref.gif \
	manual/mod/mod_ssl/ssl_template.title-toc.gif \
	manual/mod/mod_ssl/ssl_template.title-tutor.gif \
	manual/mod/mod_status.html \
	manual/mod/mod_unique_id.html.en \
	manual/mod/mod_unique_id.html.ja.jis \
	manual/mod/mod_userdir.html.en \
	manual/mod/mod_userdir.html.ja.jis \
	manual/mod/mod_usertrack.html \
	manual/mod/mod_vhost_alias.html \
	manual/mod/module-dict.html.en \
	manual/mod/module-dict.html.ja.jis \
	manual/multilogs.html \
	manual/process-model.html.en \
	manual/process-model.html.ja.jis \
	manual/programs/apxs.html \
	manual/programs/dbmmanage.html \
	manual/programs/htdigest.html \
	manual/programs/htpasswd.html.en \
	manual/programs/htpasswd.html.ja.jis \
	manual/programs/httpd.html.en \
	manual/programs/httpd.html.ja.jis \
	manual/programs/index.html.en \
	manual/programs/index.html.ja.jis \
	manual/programs/logresolve.html \
	manual/programs/rotatelogs.html \
	manual/programs/suexec.html.en \
	manual/programs/suexec.html.ja.jis \
	manual/sections.html.en \
	manual/sections.html.ja.jis \
	manual/server-wide.html.en \
	manual/server-wide.html.fr \
	manual/server-wide.html.ja.jis \
	manual/sitemap.html \
	manual/stopping.html.en \
	manual/stopping.html.fr \
	manual/suexec.html.en \
	manual/suexec.html.ja.jis \
	manual/urlmapping.html \
	manual/vhosts/details.html \
	manual/vhosts/examples.html \
	manual/vhosts/fd-limits.html.en \
	manual/vhosts/fd-limits.html.ja.jis \
	manual/vhosts/host.html \
	manual/vhosts/index.html.en \
	manual/vhosts/index.html.ja.jis \
	manual/vhosts/ip-based.html \
	manual/vhosts/mass.html \
	manual/vhosts/name-based.html.en \
	manual/vhosts/name-based.html.ja.jis \
	manual/vhosts/vhosts-in-depth.html \
	manual/vhosts/virtual-host.html

ICONFILES= \
	icons/README \
	icons/a.gif \
	icons/a.png \
	icons/alert.black.gif \
	icons/alert.black.png \
	icons/alert.red.gif \
	icons/alert.red.png \
	icons/back.gif \
	icons/back.png \
	icons/ball.gray.gif \
	icons/ball.gray.png \
	icons/ball.red.gif \
	icons/ball.red.png \
	icons/binary.gif \
	icons/binary.png \
	icons/binhex.gif \
	icons/binhex.png \
	icons/blank.gif \
	icons/blank.png \
	icons/bomb.gif \
	icons/bomb.png \
	icons/box1.gif \
	icons/box1.png \
	icons/box2.gif \
	icons/box2.png \
	icons/broken.gif \
	icons/broken.png \
	icons/burst.gif \
	icons/burst.png \
	icons/c.gif \
	icons/c.png \
	icons/comp.blue.gif \
	icons/comp.blue.png \
	icons/comp.gray.gif \
	icons/comp.gray.png \
	icons/comp1.gif \
	icons/comp1.png \
	icons/comp2.gif \
	icons/comp2.png \
	icons/compressed.gif \
	icons/compressed.png \
	icons/continued.gif \
	icons/continued.png \
	icons/dir.gif \
	icons/dir.png \
	icons/dir2.gif \
	icons/dir2.png \
	icons/diskimg.gif \
	icons/diskimg.png \
	icons/doc.gif \
	icons/doc.png \
	icons/down.gif \
	icons/down.png \
	icons/dvi.gif \
	icons/dvi.png \
	icons/f.gif \
	icons/f.png \
	icons/folder.gif \
	icons/folder.open.gif \
	icons/folder.open.png \
	icons/folder.png \
	icons/folder.sec.gif \
	icons/folder.sec.png \
	icons/forward.gif \
	icons/forward.png \
	icons/generic.gif \
	icons/generic.png \
	icons/generic.red.gif \
	icons/generic.red.png \
	icons/generic.sec.gif \
	icons/generic.sec.png \
	icons/generic2.gif \
	icons/generic2.png \
	icons/generic3.gif \
	icons/generic3.png \
	icons/hand.right.gif \
	icons/hand.right.png \
	icons/hand.up.gif \
	icons/hand.up.png \
	icons/icon.sheet.gif \
	icons/icon.sheet.png \
	icons/image.gif \
	icons/image.png \
	icons/image1.gif \
	icons/image1.png \
	icons/image2.gif \
	icons/image2.png \
	icons/image3.gif \
	icons/image3.png \
	icons/index.gif \
	icons/index.png \
	icons/key.gif \
	icons/key.png \
	icons/layout.gif \
	icons/layout.png \
	icons/left.gif \
	icons/left.png \
	icons/link.gif \
	icons/link.png \
	icons/movie.gif \
	icons/movie.png \
	icons/p.gif \
	icons/p.png \
	icons/patch.gif \
	icons/patch.png \
	icons/pdf.gif \
	icons/pdf.png \
	icons/pie0.gif \
	icons/pie0.png \
	icons/pie1.gif \
	icons/pie1.png \
	icons/pie2.gif \
	icons/pie2.png \
	icons/pie3.gif \
	icons/pie3.png \
	icons/pie4.gif \
	icons/pie4.png \
	icons/pie5.gif \
	icons/pie5.png \
	icons/pie6.gif \
	icons/pie6.png \
	icons/pie7.gif \
	icons/pie7.png \
	icons/pie8.gif \
	icons/pie8.png \
	icons/portal.gif \
	icons/portal.png \
	icons/ps.gif \
	icons/ps.png \
	icons/quill.gif \
	icons/quill.png \
	icons/rainbow.gif \
	icons/rainbow.png \
	icons/right.gif \
	icons/right.png \
	icons/screw1.gif \
	icons/screw1.png \
	icons/screw2.gif \
	icons/screw2.png \
	icons/script.gif \
	icons/script.png \
	icons/sound.gif \
	icons/sound.png \
	icons/sound1.gif \
	icons/sound1.png \
	icons/sound2.gif \
	icons/sound2.png \
	icons/sphere1.gif \
	icons/sphere1.png \
	icons/sphere2.gif \
	icons/sphere2.png \
	icons/tar.gif \
	icons/tar.png \
	icons/tex.gif \
	icons/tex.png \
	icons/text.gif \
	icons/text.png \
	icons/transfer.gif \
	icons/transfer.png \
	icons/unknown.gif \
	icons/unknown.png \
	icons/up.gif \
	icons/up.png \
	icons/uu.gif \
	icons/uu.png \
	icons/uuencoded.gif \
	icons/uuencoded.png \
	icons/world1.gif \
	icons/world1.png \
	icons/world2.gif \
	icons/world2.png

all: 	prereq
	@@cd ${.OBJDIR} && ${MAKE} OPTIM="${CFLAGS} ${COPTS}"

prereq: ${.OBJDIR}/config.status

${.OBJDIR}/config.status : ${.OBJDIR}/config.layout
	@@cd ${.OBJDIR} && CC="${CC}" OPTIM="${CFLAGS} ${COPTS}" \
	    LD_SHLIB="${CC}" PATH="/sbin:/usr/sbin:/bin:/usr/bin" \
	    ${SHELL} configure ${CONFIG_ARGS}

.if !exists(${.OBJDIR}/config.layout)
${.OBJDIR}/config.layout: ${.CURDIR}/config.layout
	lndir -s -e obj -e obj.${MACHINE_ARCH} -e Makefile.bsd-wrapper \
	    ${.CURDIR}
.endif

includes: prereq
	@@-for i in ${INCFILES}; do \
		j=$$(basename $$i); \
		echo "Installing ${DESTDIR}${HTTPD_INCLUDEDIR}/$$j"; \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m ${NONBINMODE} \
		    ${.OBJDIR}/$$i ${DESTDIR}${HTTPD_INCLUDEDIR}; \
	done

install: maninstall includes
	${INSTALL} -c -o ${DOCOWN} -g ${DOCGRP} -m ${DOCMODE} \
	    ${.CURDIR}/LICENCE.httpd ${DESTDIR}${DOCDIR}/legal/
	@@-for i in ${BINFILES}; do \
		j=$$(basename $$i); \
		echo "Installing ${DESTDIR}${HTTPD_BINDIR}/$$j"; \
		${INSTALL} ${INSTALL_COPY} ${INSTALL_STRIP} -g ${BINGRP} \
		    -m ${BINMODE} ${.OBJDIR}/$$i ${DESTDIR}${HTTPD_BINDIR}; \
	done
	@@-for i in ${SBINFILES}; do \
		j=$$(basename $$i); \
		echo "Installing ${DESTDIR}${HTTPD_SBINDIR}/$$j"; \
		${INSTALL} ${INSTALL_COPY} ${INSTALL_STRIP} -g ${BINGRP} \
		    -m ${BINMODE} ${.OBJDIR}/$$i ${DESTDIR}${HTTPD_SBINDIR}; \
	done
	@@-for i in ${INSTALL_MODULES}; do \
		j=$$(basename $$i); \
		echo "Installing ${DESTDIR}${HTTPD_LIBEXECDIR}/$$j"; \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m ${NONBINMODE} \
		    ${.OBJDIR}/$$i ${DESTDIR}${HTTPD_LIBEXECDIR}; \
	done
	@@d=$$(mktemp -d /tmp/httpdXXXXXXXXXX); \
	echo "Installing ${DESTDIR}${HTTPD_BINDIR}/apxs"; \
	j="sed -e 's;^#!/.*;#!${PERLPATH};' \
		-e 's;\@@prefix\@@;${HTTPD_PREFIX};' \
		-e 's;\@@sbindir\@@;${HTTPD_SBINDIR};' \
		-e 's;\@@libexecdir\@@;${HTTPD_LIBEXECDIR};' \
		-e 's;\@@includedir\@@;${HTTPD_INCLUDEDIR};' \
		-e 's;\@@sysconfdir\@@;${HTTPD_SYSCONFDIR};' \
		<${.OBJDIR}/src/support/apxs >$$d/apxs && \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m ${BINMODE} \
		$$d/apxs ${DESTDIR}${HTTPD_SBINDIR}"; \
		echo $$j; \
		eval $$j; \
	echo "Installing ${DESTDIR}${HTTPD_BINDIR}/dbmmanage"; \
	j="sed -e 's;^#!/.*;#!${PERLPATH};' \
		<${.OBJDIR}/src/support/dbmmanage >$$d/dbmmanage && \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m ${BINMODE} \
		$$d/dbmmanage ${DESTDIR}${HTTPD_BINDIR}"; \
		echo $$j; \
		eval $$j; \
	rm -rf $$d

.if ${.OBJDIR} == ${.CURDIR}
clean: prereq cleanman
	@@cd ${.OBJDIR} && ${MAKE} clean  && rm -f ${MUNGEDFILES}
.else
clean: cleanman
	@@cd ${.OBJDIR} && find . \! -type d -print | xargs rm
.endif

cleandir: clean

test:
	# Nothing here so far...

depend: prereq
	# Nothing here so far...

lint:
	# Nothing here so far...

tags:
	# Nothing here so far...

.if defined(NOMAN) && ${NOMAN:L} != "no"
maninstall:
	@@echo NOMAN is set
cleanman:
	@@echo NOMAN is set
.endif

distribution:
	@@-for i in ${CONFFILES}; do \
		j=$$(dirname $$i); \
		echo "Installing ${DESTDIR}${HTTPD_PREFIX}/$$i"; \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m ${NONBINMODE} \
		    ${.OBJDIR}/$$i ${DESTDIR}${HTTPD_PREFIX}/$$j/; \
	done
	@@-for i in ${HTDOCS}; do \
		j=$$(dirname $$i); \
		echo "Installing ${DESTDIR}${HTTPD_PREFIX}/$$i"; \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m ${NONBINMODE} \
		    ${.OBJDIR}/$$i ${DESTDIR}${HTTPD_PREFIX}/$$j/; \
	done
	@@-for i in ${MANUALFILES}; do \
		j=$$(dirname $$i); \
		echo "Installing ${DESTDIR}${HTTPD_HTDOCSDIR}/$$i"; \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m ${NONBINMODE} \
		    ${.OBJDIR}/htdocs/$$i ${DESTDIR}${HTTPD_HTDOCSDIR}/$$j/; \
	done
	@@-for i in ${CGIFILES}; do \
		j=$$(dirname $$i); \
		echo "Installing ${DESTDIR}${HTTPD_PREFIX}/$$i"; \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m 000 \
		    ${.OBJDIR}/$$i ${DESTDIR}${HTTPD_PREFIX}/$$j/; \
	done
	@@-for i in ${ICONFILES}; do \
		j=$$(dirname $$i); \
		echo "Installing ${DESTDIR}${HTTPD_PREFIX}/$$i"; \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m ${NONBINMODE} \
		    ${.OBJDIR}/$$i ${DESTDIR}${HTTPD_PREFIX}/$$j/; \
	done

.include <bsd.obj.mk>
.include <bsd.subdir.mk>
.if !defined(NOMAN) || ${NOMAN:L} == "no"
.  include <bsd.man.mk>
.endif
@


1.1
log
@Initial revision
@
text
@d1 2
a2 1
# Build wrapper for Apache 
a4 4
# Our lndir is hacked; specify a full path to avoid potential conflicts
# with the one installed with X11.
LNDIR=	/usr/bin/lndir

d7 2
a8 2
#    OpenBSD Layout
#<Layout OpenBSD>
d13 1
a13 1
#    libexecdir:    $exec_prefix/lib/apache/modules
d19 1
d21 1
a21 1
#    includedir:    $exec_prefix/lib/apache/include
d32 1
a32 1
HTTPD_LIBEXECDIR=	${HTTPD_EXEC_PREFIX}/lib/apache/modules
d36 1
a36 1
HTTPD_INCLUDEDIR=	${HTTPD_EXEC_PREFIX}/lib/apache/include
d40 7
a46 7
CONFIG_ARGS=	--with-layout="OpenBSD" --enable-module="ssl" \
	--enable-module="keynote" \
	--enable-suexec --suexec-caller="www" \
	--suexec-docroot="${HTTPD_HTDOCSDIR}" \
	--suexec-logfile="/var/log/suexec_log" --suexec-userdir="public_html" \
	--suexec-uidmin="1000" --suexec-gidmin="1000" \
	--suexec-safepath="/usr/bin:/bin:/usr/local/bin"
d48 1
a48 1
# This is stupid - to build a DSO module for Apache you not only need to
d93 1
a93 1
	--enable-shared=vhost_alias 
d98 1
a98 1
# modules that come with Apache.
d100 1
a100 1
.if !defined(NOPIC)
d127 1
a127 1
MUNGEDFILES =	${.OBJDIR}/src/ap/Makefile \
a128 2
		${.OBJDIR}/src/lib/expat-lite/Makefile \
		${.OBJDIR}/src/lib/Makefile \
d157 3
a159 4
MAN+=	src/support/dbmmanage.1 src/support/htdigest.1 src/support/htpasswd.1 \
	src/support/apachectl.8 src/support/logresolve.8 \
	httpd.8 src/support/rotatelogs.8 src/support/apxs.8 \
	src/support/suexec.8
d199 2
a202 1
	src/modules/ssl/ssl_util_sdbm.h \
a205 13
XMLFILES= \
	src/lib/expat-lite/asciitab.h \
	src/lib/expat-lite/hashtable.h \
	src/lib/expat-lite/iasciitab.h \
	src/lib/expat-lite/latin1tab.h \
	src/lib/expat-lite/nametab.h \
	src/lib/expat-lite/utf8tab.h \
	src/lib/expat-lite/xmldef.h \
	src/lib/expat-lite/xmlparse.h \
	src/lib/expat-lite/xmlrole.h \
	src/lib/expat-lite/xmltok.h \
	src/lib/expat-lite/xmltok_impl.h

d207 10
a216 10
	conf/httpd.conf-dist conf/httpd.conf \
	conf/mime.types conf/magic

HTDOCS= \
	htdocs/apache_pb.gif htdocs/index.html htdocs/openbsdpower.gif \
	htdocs/blowfish.jpg htdocs/bsd_small.gif htdocs/lock.gif \
	htdocs/logo23.jpg htdocs/logo24.jpg htdocs/smalltitle.gif \
	htdocs/openbsd_pb.gif

CGIFILES=	cgi-bin/printenv cgi-bin/test-cgi	
a218 12
	manual/FAQ.html \
	manual/howto/auth.html \
	manual/howto/htaccess.html \
	manual/howto/cgi.html.en \
	manual/howto/cgi.html.html \
	manual/howto/cgi.html.ja.jis \
	manual/howto/footer.html \
	manual/howto/header.html \
	manual/howto/ssi.html.en \
	manual/howto/ssi.html.html \
	manual/howto/ssi.html.ja.jis \
	manual/LICENSE \
a220 1
	manual/bind.html.html \
a221 4
	manual/cgi_path.html.en \
	manual/cgi_path.html.fr \
	manual/cgi_path.html.html \
	manual/cgi_path.html.ja.jis \
a223 1
	manual/configuring.html.html \
a225 1
	manual/content-negotiation.html.html \
a228 1
	manual/custom-error.html.html \
a229 1
	manual/cygwin.html \
d232 1
a232 1
	manual/dns-caveats.html.html \
a233 1
	manual/ebcdic.html \
a234 1
	manual/env.html.html \
a235 1
	manual/footer.html \
a236 1
	manual/handler.html.html \
d238 6
a243 21
	manual/header.html \
	manual/index.html.en \
	manual/index.html.fr \
	manual/index.html.html \
	manual/index.html.ja.jis \
	manual/install-tpf.html \
	manual/install.html.en \
	manual/install.html.es \
	manual/install.html.fr \
	manual/install.html.html \
	manual/install.html.ja.jis \
	manual/invoking.html.en \
	manual/invoking.html.fr \
	manual/invoking.html.html \
	manual/keepalive.html.en \
	manual/keepalive.html.html \
	manual/keepalive.html.ja.jis \
	manual/location.html \
	manual/logs.html \
	manual/images/apache_header.gif \
	manual/images/apache_pb.gif \
d256 11
a266 14
	manual/man-template.html \
	manual/mpeix.html \
	manual/multilogs.html \
	manual/netware.html \
	manual/new_features_1_0.html \
	manual/new_features_1_1.html \
	manual/new_features_1_2.html \
	manual/new_features_1_3.html.en \
	manual/new_features_1_3.html.html \
	manual/new_features_1_3.html.ja.jis \
	manual/new_features_2_0.html \
	manual/process-model.html.en \
	manual/process-model.html.html \
	manual/process-model.html.ja.jis \
a267 1
	manual/misc/FAQ.html \
a273 2
	manual/misc/footer.html \
	manual/misc/header.html \
a276 1
	manual/misc/nopgp.html \
a277 2
	manual/misc/perf-dec.html \
	manual/misc/perf-hp.html \
a282 73
	manual/misc/vif-info.html \
	manual/misc/windoz_keepalive.html \
	manual/readme-tpf.html \
	manual/sections.html.en \
	manual/sections.html.html \
	manual/sections.html.ja.jis \
	manual/server-wide.html.en \
	manual/server-wide.html.fr \
	manual/server-wide.html.html \
	manual/server-wide.html.ja.jis \
	manual/sitemap.html \
	manual/sourcereorg.html \
	manual/stopping.html.en \
	manual/stopping.html.fr \
	manual/stopping.html.html \
	manual/suexec.html.en \
	manual/suexec.html.html \
	manual/suexec.html.ja.jis \
	manual/suexec_1_2.html \
	manual/mod/mod_ssl/index.html \
	manual/mod/mod_ssl/ssl_compat.gfont000.gif \
	manual/mod/mod_ssl/ssl_compat.html \
	manual/mod/mod_ssl/ssl_compat.wml \
	manual/mod/mod_ssl/ssl_cover.wml \
	manual/mod/mod_ssl/ssl_cover_logo.jpg \
	manual/mod/mod_ssl/ssl_cover_title.jpg \
	manual/mod/mod_ssl/ssl_faq.gfont000.gif \
	manual/mod/mod_ssl/ssl_faq.html \
	manual/mod/mod_ssl/ssl_faq.wml \
	manual/mod/mod_ssl/ssl_glossary.html \
	manual/mod/mod_ssl/ssl_glossary.wml \
	manual/mod/mod_ssl/ssl_howto.gfont000.gif \
	manual/mod/mod_ssl/ssl_howto.html \
	manual/mod/mod_ssl/ssl_howto.wml \
	manual/mod/mod_ssl/ssl_intro.gfont000.gif \
	manual/mod/mod_ssl/ssl_intro.html \
	manual/mod/mod_ssl/ssl_intro.wml \
	manual/mod/mod_ssl/ssl_intro_fig1.gif \
	manual/mod/mod_ssl/ssl_intro_fig2.gif \
	manual/mod/mod_ssl/ssl_intro_fig3.gif \
	manual/mod/mod_ssl/ssl_overview.gfont000.gif \
	manual/mod/mod_ssl/ssl_overview.html \
	manual/mod/mod_ssl/ssl_overview.wml \
	manual/mod/mod_ssl/ssl_overview_fig1.gif \
	manual/mod/mod_ssl/ssl_reference.gfont000.gif \
	manual/mod/mod_ssl/ssl_reference.html \
	manual/mod/mod_ssl/ssl_reference.wml \
	manual/mod/mod_ssl/ssl_template.head-chapter.gif \
	manual/mod/mod_ssl/ssl_template.head-num-1.gif \
	manual/mod/mod_ssl/ssl_template.head-num-2.gif \
	manual/mod/mod_ssl/ssl_template.head-num-3.gif \
	manual/mod/mod_ssl/ssl_template.head-num-4.gif \
	manual/mod/mod_ssl/ssl_template.head-num-5.gif \
	manual/mod/mod_ssl/ssl_template.head-num-6.gif \
	manual/mod/mod_ssl/ssl_template.head-num-7.gif \
	manual/mod/mod_ssl/ssl_template.imgdot-1x1-000000.gif \
	manual/mod/mod_ssl/ssl_template.imgdot-1x1-transp.gif \
	manual/mod/mod_ssl/ssl_template.inc \
	manual/mod/mod_ssl/ssl_template.navbut-next-n.gif \
	manual/mod/mod_ssl/ssl_template.navbut-next-s.gif \
	manual/mod/mod_ssl/ssl_template.navbut-prev-n.gif \
	manual/mod/mod_ssl/ssl_template.navbut-prev-s.gif \
	manual/mod/mod_ssl/ssl_template.title-abstract.gif \
	manual/mod/mod_ssl/ssl_template.title-compat.gif \
	manual/mod/mod_ssl/ssl_template.title-faq.gif \
	manual/mod/mod_ssl/ssl_template.title-gloss.gif \
	manual/mod/mod_ssl/ssl_template.title-howto.gif \
	manual/mod/mod_ssl/ssl_template.title-intro.gif \
	manual/mod/mod_ssl/ssl_template.title-over.gif \
	manual/mod/mod_ssl/ssl_template.title-preface.gif \
	manual/mod/mod_ssl/ssl_template.title-ref.gif \
	manual/mod/mod_ssl/ssl_template.title-toc.gif \
	manual/mod/mod_ssl/ssl_template.title-tutor.gif \
a285 1
	manual/mod/core.html.html \
a287 1
	manual/mod/directive-dict.html.html \
a291 1
	manual/mod/directives.html.html \
a292 3
	manual/mod/footer.html \
	manual/mod/header.html \
	manual/mod/index.html.en \
a294 1
	manual/mod/index-bytype.html.html \
d296 1
a297 1
	manual/mod/index.html.html \
a299 1
	manual/mod/mod_access.html.html \
a301 1
	manual/mod/mod_actions.html.html \
a303 1
	manual/mod/mod_alias.html.html \
a305 1
	manual/mod/mod_asis.html.html \
a307 1
	manual/mod/mod_auth.html.html \
d313 2
a314 1
	manual/mod/mod_autoindex.html \
a317 1
	manual/mod/mod_cgi.html.html \
a322 1
	manual/mod/mod_dir.html.html \
a325 1
	manual/mod/mod_env.html.html \
a332 1
	manual/mod/mod_info.html.html \
a337 1
	manual/mod/mod_log_config.html.html \
a340 1
	manual/mod/mod_mime.html.html \
a344 1
	manual/mod/mod_negotiation.html.html \
a347 1
	manual/mod/mod_rewrite.html.html \
d350 1
a350 1
	manual/mod/mod_setenvif.html.html \
a351 2
	manual/mod/mod_setenvif.html.ja.jis \
	manual/mod/mod_so.html.html \
a353 1
	manual/mod/mod_speling.html.html \
d355 54
a410 1
	manual/mod/mod_unique_id.html.html \
a412 1
	manual/mod/mod_userdir.html.html \
a416 1
	manual/mod/module-dict.html.html \
d418 3
a420 15
	manual/unixware.html \
	manual/upgrading_to_1_3.html \
	manual/urlmapping.html \
	manual/win_compiling.html.en \
	manual/win_compiling.html.html \
	manual/win_compiling.html.ja.jis \
	manual/win_service.html.en \
	manual/win_service.html.html \
	manual/win_service.html.ja.jis \
	manual/windows.html.en \
	manual/windows.html.ja.jis \
	manual/programs/ab.html \
	manual/programs/apachectl.html.en \
	manual/programs/apachectl.html.html \
	manual/programs/apachectl.html.ja.jis \
a422 2
	manual/programs/footer.html \
	manual/programs/header.html \
a424 1
	manual/programs/htpasswd.html.html \
a426 1
	manual/programs/httpd.html.html \
a428 1
	manual/programs/index.html.html \
a430 1
	manual/programs/other.html \
a432 1
	manual/programs/suexec.html.html \
d434 11
a444 1
	manual/search/manual-index.cgi \
a445 1
	manual/vhosts/details_1_2.html \
a447 1
	manual/vhosts/fd-limits.html.html \
a448 2
	manual/vhosts/footer.html \
	manual/vhosts/header.html \
a450 1
	manual/vhosts/index.html.html \
a454 1
	manual/vhosts/name-based.html.html \
d458 1
a458 1
	
a459 1
	icons/back.gif \
a462 65
	icons/small/README.txt \
	icons/small/back.gif \
	icons/small/back.png \
	icons/small/binary.gif \
	icons/small/binary.png \
	icons/small/binhex.gif \
	icons/small/binhex.png \
	icons/small/blank.gif \
	icons/small/blank.png \
	icons/small/broken.gif \
	icons/small/broken.png \
	icons/small/burst.gif \
	icons/small/burst.png \
	icons/small/comp1.gif \
	icons/small/comp1.png \
	icons/small/comp2.gif \
	icons/small/comp2.png \
	icons/small/compressed.gif \
	icons/small/compressed.png \
	icons/small/continued.gif \
	icons/small/continued.png \
	icons/small/dir.gif \
	icons/small/dir.png \
	icons/small/dir2.gif \
	icons/small/dir2.png \
	icons/small/doc.gif \
	icons/small/doc.png \
	icons/small/forward.gif \
	icons/small/forward.png \
	icons/small/generic.gif \
	icons/small/generic.png \
	icons/small/generic2.gif \
	icons/small/generic2.png \
	icons/small/generic3.gif \
	icons/small/generic3.png \
	icons/small/image.gif \
	icons/small/image.png \
	icons/small/image2.gif \
	icons/small/image2.png \
	icons/small/index.gif \
	icons/small/index.png \
	icons/small/key.gif \
	icons/small/key.png \
	icons/small/movie.gif \
	icons/small/movie.png \
	icons/small/patch.gif \
	icons/small/patch.png \
	icons/small/ps.gif \
	icons/small/ps.png \
	icons/small/rainbow.gif \
	icons/small/rainbow.png \
	icons/small/sound.gif \
	icons/small/sound.png \
	icons/small/sound2.gif \
	icons/small/sound2.png \
	icons/small/tar.gif \
	icons/small/tar.png \
	icons/small/text.gif \
	icons/small/text.png \
	icons/small/transfer.gif \
	icons/small/transfer.png \
	icons/small/unknown.gif \
	icons/small/unknown.png \
	icons/small/uu.gif \
	icons/small/uu.png \
d467 1
a467 2
	icons/apache_pb.gif \
	icons/apache_pb.png \
d495 4
d505 2
d509 2
a510 1
	icons/dvi.gif \
d513 1
d531 4
d541 2
d551 2
d591 2
d601 2
a631 2
.include <bsd.own.mk>

d633 1
a633 1
	@@cd ${.OBJDIR} && ${MAKE}
d635 1
a635 1
prereq: ${.OBJDIR}/config.status 
d637 4
a640 5
${.OBJDIR}/config.status : ${.OBJDIR}/config.layout 
	@@cd ${.OBJDIR} && CC="${CC}" LD_SHLIB="${CC}" \
		OPTIM="${CFLAGS} ${COPTS}" \
		PATH="/sbin:/usr/sbin:/bin:/usr/bin" \
			sh configure ${CONFIG_ARGS}
d644 2
a645 1
	${LNDIR} -s -e obj -e obj.${MACHINE_ARCH} -e Makefile.bsd-wrapper ${.CURDIR}
a647 1

d650 1
a650 1
		j=`basename $$i`; \
d652 1
a652 1
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m 444 \
a654 6
	@@-for i in ${XMLFILES}; do \
		j=`basename $$i`; \
		echo "Installing ${DESTDIR}${HTTPD_INCLUDEDIR}/xml/$$j"; \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m 444 \
		    ${.OBJDIR}/$$i ${DESTDIR}${HTTPD_INCLUDEDIR}/xml; \
	done
d656 3
a658 1
install: maninstall
d660 1
a660 1
		j=`basename $$i`; \
d663 1
a663 1
		    -m 555 ${.OBJDIR}/$$i ${DESTDIR}${HTTPD_BINDIR}; \
d666 1
a666 1
		j=`basename $$i`; \
d669 1
a669 1
		    -m 555 ${.OBJDIR}/$$i ${DESTDIR}${HTTPD_SBINDIR}; \
d672 1
a672 1
		j=`basename $$i`; \
d674 1
a674 1
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m 444 \
d677 1
a677 1
	@@d=`mktemp -d /tmp/httpdXXXXXXXXXX`; \
d685 2
a686 2
		< ${.OBJDIR}/src/support/apxs > $$d/apxs && \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m 555 \
a689 8
	echo "Installing ${DESTDIR}${HTTPD_BINDIR}/apachectl"; \
	j="sed -e 's;PIDFILE=.*;PIDFILE=${HTTPD_RUNDIR}/httpd.pid;' \
		-e 's;HTTPD=.*;HTTPD=${HTTPD_SBINDIR}/httpd;' \
		< ${.OBJDIR}/src/support/apachectl > $$d/apachectl && \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m 555 \
		$$d/apachectl ${DESTDIR}${HTTPD_SBINDIR}"; \
		echo $$j; \
		eval $$j; \
d692 2
a693 2
		< ${.OBJDIR}/src/support/dbmmanage > $$d/dbmmanage && \
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m 555 \
d702 1
a702 1
.else 	
d721 1
a721 1
.ifdef NOMAN
d730 1
a730 1
		j=`dirname $$i`; \
d732 1
a732 1
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m 444 \
d736 1
a736 1
		j=`dirname $$i`; \
d738 1
a738 1
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m 444 \
d742 1
a742 1
		j=`dirname $$i`; \
d744 1
a744 1
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m 444 \
d748 1
a748 1
		j=`dirname $$i`; \
d754 1
a754 1
		j=`dirname $$i`; \
d756 1
a756 1
		${INSTALL} ${INSTALL_COPY} -g ${BINGRP} -m 444 \
d762 2
a763 2
.ifndef NOMAN
.include <bsd.man.mk>
@


1.1.1.1
log
@Import base OpenBSD repository of MirOS ocvs:HEAD
@
text
@@
