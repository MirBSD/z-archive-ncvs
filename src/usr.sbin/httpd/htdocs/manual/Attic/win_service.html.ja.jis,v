head	1.2;
access;
symbols
	cvs-200501160850:1.1.1.1
	prone-for-deletion:1.1
	start:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2005.01.03.15.07.00;	author tg;	state dead;
branches;
next	1.1;

1.1
date	2004.12.12.21.35.10;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2004.12.12.21.35.10;	author tg;	state Exp;
branches;
next	;


desc
@@


1.2
log
@remove some orphanes:
- stuff which was (wrongly) contained within the -bopenbsd import,
  because it happened to have existed earlier in openbsd
- stuff which was (correctly) contained within the -bopenbsd
  import, and we removed in -bmirbsd
@
text
@<?xml version="1.0" encoding="iso-2022-jp"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
  <head>

    <title>Windows で Apache をサービスとして動かす</title>

 </head>
  <!-- English revision:1.9 -->
  <!-- Background white, links blue (unvisited), navy (visited), red (active) -->
  <body bgcolor="#ffffff" text="#000000" link="#0000ff"
  vlink="#000080" alink="#ff0000">
        <div align="CENTER">
      <img src="images/sub.gif" alt="[APACHE DOCUMENTATION]" /> 

      <h3>Apache HTTP Server</h3>
    </div>



    <h1 align="center">Windows で Apache をサービスとして動かす</h1>

    <p>Windows NT/2000 では Apache
    をサービスとして動かすことができます。(Apache 1.3.13
    で、非常に実験的に<a href="#win95svc">Windows 95/98</a>
    においても同様の動作をサポートをするようになりました)。</p>

    <p>サービスとして Apache をインストールするには、
    コンソールウィンドウでたった一度この実行が誓任譴个いい呂困任后
草痺蒹ぢをサービスとしてインストールしたり、動かそうとする前に <a
    href="windows.html">Microsoft Windows で Apache を動かす</a>
    を参照してくだ世気ぁ蔗筮竢鈕ぢファイルへの変更はコンソールウィンドウで
    Apache を起動することにより、いつも反映されます。
    これでうまくいけば、サービスは誓垢襪任靴腓Α鹿霈

腫昭齡鳫鈑ぢ注意: バージョン 1.3.13 より前ではインストール実行前に
    誓瀋蠅弱躱テストされません</em></strong>。サービスの依存誓良埖
原因で、コンソールウィンドウではしばしばうまくいきますが、
    サービスはまだ声最圓靴泙后草痺蒹ぢの 1.3.13 より前のバージョンを
    動かすときに問題があるならば、<a href="#service">後述の誓睫誓</a>
    を参照してくだ世気ぁ弌璽献腑以降でこの問題があるなら、
    まず最初に Apache をアンインストール (-u) してから再インストール
    (-i) を試してみてくだ世気ぁ
もっとよい手段は最新のバージョンにアップグレードすることです。</p>
    <hr />

    <p>Apache をサービスとして開始するためには、まず最初にサービスとして
    インストールする必要があります。それぞれ別の名前と誓瀋蠅鮖箸辰董
草痺蒹ぢサービスを複数インストールすることができます。デフォルトの
    "Apache" という名前で Apache サービスをインストールするには、スタート
    メニューから "Install Apache as Service" オプションを実行してくだ世気ぁ
これを一度行なえば、(コントロールパネル中の) サービスウィンドウ
    （Windows 2000では管理ツールの中にあります）を開いて、Apache を選択して、
    次に Start をクリックすることで、"Apache" サービスを開始できます。
    これで Apache はバックグラウンドで動きます。
    その後は Stop をクリックすることで、Apache を終了できます。
    サービスウィンドウを使う代わりに、コマンドラインから、
    以下を実行することで、"Apache" サービスを開始、終了できます。</p>
<pre>
  NET START APACHE
  NET STOP APACHE
</pre>

    <p>Apache サービスのインストールとコントロールに関するさらなる情報は、
    <a href="#signal">Apache サービスのコントロール</a>を参照してくだ世気ぁ
鹿霈

腫昭齡鳫鈑樵鞜竏は、他の多くの Windows NT/2000 のサービスと異なり、
    ほとんどのエラーは独自に Apache のサーバルートの logs フォルダ世砲△
纈鳫鬯跫ファイルに記録します。ほとんどの Apache のエラーに関する
    詳細はWindows NT のイベントログでは分からないでしょう。Apache
    を起動しようとしたときに発誓犬靴織┘蕁爾誓けがイベントログに記録されます。
    </strong></p>

    <p>Apache をサービスとして開始した後 (または、開始することに問題が
    あれば)、コンソールウィンドウから同じ<a href="windows.html#test">手順</a>
    でテストできます。デフォルトのサービス誓瀋蠅魍稜Г垢襪燭瓩砲蓮
このコマンド:</p>
<pre>
  apache -n "service name"
</pre>

    <p>を使うことを覚えておいてくだ世気ぁ鹿霈


取仮釈篏‰纈竇釶辣就黼鴟蜒紜衝蜴粹ぢで Apache をサービスとして
    動かす</a></h2>

    <p><strong>注意: サービス名を指定する -n オプションは Apache 1.3.7
    以降でのみ利用可能です。</strong> 以前のバージョンの Apache では、
    デフォルトのサービス名 'Apache' だ世韻汽檗璽箸気譴討い泙后
バージョン 1.3.21 に限り、Windows 2000 でサービス名として表示される
    名前の変更がサポートされています。</p>

    <p>以下のようにすることで、Apache を Windows NT のサービスとして
    インストールできます:</p>
<pre>
    apache -i -n "service name"
</pre>

    <p>特定の誓瀋蠅鮖箸辰謄機璽咼垢鬟ぅ鵐好函璽襪垢襪砲蓮
インストールの際に誓瀋螢侫．ぅ襪鮖慊蠅靴討誓さい:</p>

<pre>
    apache -i -n "service name" -f "\my server\conf\my.conf"
</pre>

    <p>サーバルートディレクトリをデフォルトから変更するための -d、
    誓瀋螢侫．ぅ襪鯤儿垢垢襪燭瓩潮や -c など、その他の属誓
省略できます。これらがレジストリに書き込まれていて変更が困難なときは、
    このコマンドを使ってオプションをクリアし、新しいオプションに置き換えます。
    </p>
<pre>
    apache -k config -n "service name" -f "\my server\conf\my.conf"
</pre>

    <p>Apache サービスを削除するには、以下のようにします:</p>
<pre>
    apache -u -n "service name"
</pre>

    <p>サービス名が指定されない場合のデフォルトの「サービス名」は
    "Apache" となります。</p>

    <p>サービスがインストールされると、サービスの誓瀋螢侫．ぅ襪鮗┐垢里
他のオプションと同時に <samp>-n</samp> オプションを使用することが
    できます。例:</p>

    <p>サービスの誓瀋螢侫．ぅ襪鬟謄好箸靴董▲機璽咼垢離妊侫襯箸
オプションを確認するには次のようにします（誓瀋蠅砲薔蜴齡瘡讙
闔肅オプションを使います) 例:</p>
<pre>
    apache -n "service name" -t
</pre>

    <p>サービスの誓瀋螢侫．ぅ襪肇妊侫襯箸離廛轡腑鵑鮖藩僂靴董
コンソールから Apache を起動するには次のようにします:</p>
<pre>
    apache -n "service name"
</pre>

    <p>Apache リリース 1.3.15 で -k install オプションが -i オプションの、
    また、-k uninstall オプションが -u オプションの別名として追加されました。
    元の -i そして -u オプションは Apache 2.0 では使用しないようにしてくだ世気ぁ
これらの別名は、両方のバージョンを運用する管理者が (訳注: Apache 2.0 に)
    移行しやすくするために追加されました。</p>

    <h2><a id="depends" name="depends">サービスの依存に関する重要な留意点鹿畩
鹿莢
腫ぢリリース 1.3.13 以前の Apache では、インストールされたサービスが
    うまく開始することが前提条件となる依存関係は構誓気譴泙擦鵝
草痺蒹ぢの以前のバージョンを使用してサービスをインストールした後に、
    以下の手順を踏まなければなりません : </p>
<pre>
    Run regedt32
    Select <u>W</u>indow - "HKEY_LOCAL_MACHINE on Local Machine" from the menu
    Double-click to open the SYSTEM, then the CurrentControlSet keys
    Scroll down and click on the Apache servicename
    Select <u>E</u>dit - Add <u>V</u>alue... from the menu
    Fill in the Add Value dialog with 
        <u>V</u>alue Name: DependOnGroup 
        <u>D</u>ata Type: REG_MULTI_SZ
        and click OK
    Leave the Multi-String Editor dialog empty and click OK
    Select <u>E</u>dit - Add <u>V</u>alue... from the menu
    Fill in the Add Value dialog with 
        <u>V</u>alue Name: DependOnService
        <u>D</u>ata Type: REG_MULTI_SZ
        and click OK
    Type the following list (one per line) in the Multi-String Editor dialog
        Tcpip
        Afd
        and click OK
</pre>

    <p>また、サードパーティーのモジュール、ISAPI、その他 ActiveState Perl
    などによる、COM や DCOM の構誓彖任鮖藩僂靴討い襪覆蕕弌偵鞳鈔嚆鴟蜒リストに Rpcss のエントリーを追加する必要があるかもしれません。
    それが不要な場合に、TCP ポート 135 を露出するのを避けるために、
    Apache はインストールのときにそのエントリーを作誓靴泙擦鵝
上の指示に従って、DependOnService 値を確認、または作誓靴討誓さい。
    既に存在しているならばその値をダ瀬屮襯螢奪靴董咒笂のエントリーを
    リストに追加してくだ世気ぁ鹿霈

腫ぢ依存誓里燭瓩泙誓他に何かインストールが要求されるかもしれません。
    開始時にネットワークドライブ上に存在するファイルを要求される場合、
    まず最初にネットワークリダ瀬ぅ譽ぢ通常 lanmanworkstation)
    の依存誓亡悗錣襯機璽咼垢鮴設定して、" ユーザアカウントで Apache
    を動かす " セクション以下の誓睫誓に従ってくだ世気鹿霈

腫症瓶ぢと Apache の両方を使おうとするなら、異なる IP
    アドレスの同じポート番号で W3SVC (IIS) を Apache
    の前に開始させておく必要があります。なぜなら、Apache が誓茲貌団蠅
賓ぢアドレスで開始していると、IIS は開始するときに全ての IP アドレス
    (0.0.0.0) を確保しようとして失敗するからです。</p>

    <p>Apache 1.3.21 で依存誓魏辰┐襪呂襪肪噂磴癖，各気譴泙靴拭
サービス名" 引数は Apache の依存誓鮴設定する -k install や
    -k config コマンドに機能を付け加えます。複数の -W
    引数が与えられますが、すべて -k オプションの後ろで指定するべきです。
    例えば、インストール済みの "Apache" サービスに LanmanWorkstation
    依存誓魏辰┐襪覆蕁△海離灰泪鵐匹鮖箸い泙后鹿霈
腫鱚瘰痺蒹竢鈕蜃草痺蒹戻鉈瘤恟鳬齡癆蜿鹿頏緇

取仮ユーザアカウントで Apache を動かす (NT/2000)</h2>

    <p>Apache が最初にサービス ( 例えば、-i オプション ) としてインストールされるとき、
    "System" というユーザ (LocalSystem アカウント ) で動作するでしょう。
    もし web サーバのすべてのリソースがローカルシステム上にあるなら
    ほとんど問題ありませんが、(LocalSystem アカウント ) はローカルマシンに
    影響を与える幅広いセキュリティ特権を持っています。</p>

    <blockquote>
      LocalSystem は局所的に非常に特権アカウントなので、
      どんなシェアウェアアプリケーションもそこで動作させるべきでは
      ありません。しかしながら、それはネットワーク特権を持たなくて、
      NT の機密保持機能、ファイルシステム、パイプ、DCOM 、セキュア RPC を含めて
      そのままにしておくことはできません
    </blockquote>

    <p><strong>決してシステムアカウントにネットワーク特権を与えては
    いけません !</strong> 代わりに新しいユーザアカウントを作誓靴董
そのユーザに適誓擇文造鰺燭┐董閾蒼というオプションを
    使ってくだ世気ぁ好拭璽肇瓮縫紂ぢ誓瀋ぢコントロールパネル
    -&gt; サービス -&gt; Apache Service と選択して、「スタートアップ」
    ボタンをクリックして、この誓瀋蠅縫▲札垢靴討誓さい。</p>

    <blockquote>
      LocalSystem アカウントの環境で動作するサービスは SCM
      関連のセキュリティ環境を引き継ぎます。
      サービスはどのユーザアカウントとも関連づけられず、
      また確認に使用されるべき証明ぢドメイン名、ユーザ名、パスワード )
      を持ちません。
    </blockquote>

    <p>SYSTEM アカウントはネットワークに特権を持たないので、共有されたページや
    共有されたインストールはサービスからは見えません。
    あなたが<em>どんな</em>ネットワークリソースも使用するつもりであるならば、
    以下のステップは役に立つかもしれません</p>

    <ul>
      <li>Control Panel の Service ダ瀬ぅ▲蹈阿鞜竏を選択して、
      Startup をクリックします。</li>

      <li>サービスアカウントが誓気靴い海箸魍稜Г靴討誓さい。
      Apache サービス用のアカウントを作誓垢襪海箸發茲な，任后鹿跚
殊蘊パスワードを繰り返し入力してパスワード確認をします。</li>

      <li>ドメインのユーザマネージャに行ってくだ世気ぁ鹿跚
殊蘊タイトルバーメニューから Policies をクリックして、
      User Rights を選択してくだ世気ぁ鹿跚
殊蘊槍釿繖黼咏艾ぢのオプションを選択してくだ世気ぁ鹿跚
殊蘊
ドロップダ瀬Ε鵐螢好斑罎如∩鬚気譴織▲Ε鵐箸飽焚爾慮造
与えられたことを確認してくだ世気ぁ

受貍
殊蘊巣癈癇閹蒹鞳鱇鈑躰蘊

殊蘊逮站肅跂瘤粡鱚笏闥蜈鷦蘊

殊蘊弥闔黼鴟蜒綣蘊

殊蘊吶齡闥肅跂瘤粡鱚笏闥蜈鷦蘊
鹿鹿跚
殊蘊選択されたアカウントが Users グループのメンバであることを
      確認してくだ世気ぁ鹿跚
殊蘊選択されたアカウントがすべてのドキュメントとスクリプトディレクトリに
      アクセスする手段 (最低限読み込みとブラウズ) を持っていることを
      確認してくだ世気ぁ鹿跚
殊蘊選択されたアカウントが Apache logs ディレクトリに対して読み書き、
      削除する手段を持っていることを確認してくだ世気ぁ鹿跚鹿
腫ぢそのアカウントでユーザとしてログインすることを許可したら、
    自分自身でログインしてそのアカウントがスクリプトの実行、ウェブ
    ページの読み込みをする権限を持っていること、コンソールウィンドウから
    Apache を起動できることをテストすることができます。これがうまくいき、
    上記のステップに従って手順を踏めば、Apache は問題なくサービスとして
    実行するはずです。</p>

    <p><strong>注意: エラーコード 2186</strong> はサーバが必要な
    ネットワークリソースにアクセスすることができないので 'Log On As'
    の誓瀋蠅鮓召紘廚△襦△箸い惻┐任后鹿霈

取仮釈篏♯鳫跂釶辣就阨碎紜草痺蒹ぢを Windows でサービスとして
    動かすときの トラブルシューティング</a></h2>

    <p>サービスとして Apache を開始する場合、Windows サービスマネージャからの
    エラーメッセージを見ることになるかもしれません。例えばコントロールパネルの
    サービス アプレットを使用して Apache を開始させようとする時に、
    以下のメッセージを見るかもしれません。</p>
<pre>
  Could not start the apache service on \\COMPUTER
  Error 1067; The process terminated unexpectedly.
</pre>

    <p>Apache の開始において何らかの問題がある場合、このエラーに遭います。
    問題の原因を確認するためには、<a href="windows.html#test">コマンド
    プロンプトで Apache をテストする</a>の指示に従ってくだ世気ぁ鹿霈


腫ぢまた、Apache 1.3.13 では Windows NT/2000 でサービスとして動かすとき、
    開始時のエラーを アプリケーション ログ に記録します。イベント ビューア
    を起動し、<u>L</u>og ... <u>A</u>pplication
    と選択してイベントを確認することができます。</p>

    <p><strong>問題があった場合は、エラーが発誓犬靴燭海箸魴拗陲里燭瓩
エラーメッセージがポップアップされなくても、イベント ビューアで
    アプリケーション ログをチェックしてくだ世気ぁ鹿齡鳫鈑昭
取仮釈篏≪辟跚鈬釶辣就竝粲蜴紜衝蜴粹ぢでコマンドラインから
    Apache を動かす</a></h2>
    コマンドラインから Apache サービスを誓罎垢襪海箸亡悗垢訃楮戮砲弔い討蓮
釈鱚羹†蜴粹譯竝粲蜴紜
ぢコンソールコマンドライン</a>の章を参照してくだ世気ぁ

取仮釈篏‰蜃釶譬瘢綵‰蜃釶譬ぢサービスとしての Apache
    を誓罎垢鹿畩鹿莢
腫樵鞜竏は複数インストールして、サービスとして動かすことができます。
    インストールされた Apache サービスを開始、再開、終了、停止するには
    以下のようにします:</p>
<pre>
    apache -n "service name" -k start
    apache -n "service name" -k restart
    apache -n "service name" -k shutdown
    apache -n "service name" -k stop
</pre>

    <p>-n オプションのない -k コマンドはコンソールウィンドウで起動している
    Apache に向けられるので、デフォルトの "Apache" サービスでは -n Apache
    オプションが必要です。引用符はサービス名にスペースが含まれる場合に限り
    必要になります。</p>

    <p><strong>注意: -k shutdown コマンドの別名の -k stop コマンドは
    Apache バージョン 1.3.13 で導入されました。</strong>
    それより前のバージョンの Apache では -k shutdown
    オプションだ世韻Ъ韻気譴泙后窺凱より前の Apache
    では<em>どんな</em> -k オプションも認識されませんでした。</p>

    <p>-D, -C, -c オプションを含めた apache -k start
    コマンドで起動時のオプションを指定することもできます。
    これらはサービスの誓瀋螢廛蹈札垢鳳洞舛靴泙踉刺翊繙蜴絋苳ブロックで使うことで条件つきの指定をすることもできます。
    サーバルートのパスや -d オプションや -f
    オプションを使って誓瀋螢侫．ぅ襪鮠綵颪垢襪海箸發任泙后
これらのオプションは -k restart コマンドによっても読み込まれますが、
    サービスの動作中には反映されず、サービスの起動時にのみ反映されます。
    </p>

    <p>サービスは Windows NT/2000 の Service Control
    アプレットにも現れます。NT の場合、Settings -&gt; Control Panel
    -&gt; Services エントリ、2000 の場合、Settings -&gt; Control Panel
    -&gt; Administrative Tools -&gt; Services エントリで参照できます。
    そこから開始や終了させる Apache サービスを選択できます。
    -D, -C, -c のような追加のオプションや、開始パラメータのデフォルトの
    -d や -f オプションの上書きは開始ボタンをクリックする前にしてくだ世気ぁ
これらのオプションは apache -k start
    コマンドと全く同じように処理されます。</p>

    <p>さらに、Apache サービスの開始、終了にネイティブの
    Windows NT/2000 の NET コマンドを使うこともできます:</p>
<pre>
    NET START "service name"
    NET STOP "service name"
</pre>

    <p>繰り返しますが、サービス名がスペースを含む場合のみ、
    引用符が必要になります。-D, -c, -C などの追加オプションを
    NET START コマンドで指定する方法はありません。
    オプションが必要なときは、他の
    2 種類のメソッドのどちらかを使用してくだ世気ぁ鹿霈

取仮釈篏†蜴控齧磚瘢綵†蜴控齧磚ぢ非常に実験的な
    Windows 95/98 サービス</a></h2>

    <p><strong>注意: Windows 95 と 98 でのサービスオプションは
    Apache 1.3.13 以降でのみ有効です。</strong>以前のバージョンの
    Apache では Windows 95/98
    においてはコンソールウィンドウでのみサポートされています。</p>

    <p>Windows NT/2000 でのサービスと同じような Windows 95/98 上での
    Apache の動作をある程度サポートしています。
    それは<em>非常に実験的</em>なもので、もし (すべて順調に)
    動いたとしても Apache Software Foundation は、信頼誓箴茲離汽檗璽
は保証しません。以降については自分自身のリスクで進んでくだ世気ー
腫樵鞜竏が <a href="windows.html#test">Command Prompt</a>
    で誓犠錣貌虻遒垢襪海箸魍稜Г靴燭蕁怏鈔阯淋旭の場合と同じコマンドでインストール、誓罅
アンインストールすることができます。</p>

    <p>ただ世掘躇佞垢戮斗廚憤磴い△蠅泙瑳

腫樵鞜竏は、起動が誓垢襪函▲丱奪哀薀Ε鵐匹覇虻遒靴泙后
デスクトップのショートカットを通して、コマンド</p>
<pre>
   Apache -n "service name" -k start
</pre>

    <p>を実行したら、例えば、サービスがうまく開始されれば、
    コンソールウィンドウは表示されますがすぐに見えなくなります。
    Apache が開始時に、httpd.conf
    ファイルにおける不誓気淵┘鵐肇蠅里茲Δ淵┘蕁爾鮓弔韻襪函
コンソールウィンドウは表示されたままで残ります。
    そこには問題の原因の追求に役に立つ
    エラーメッセージが表示されているでしょう。その際 Apache の
    logs ディレクトリにある error.log ファイルを調べ直すべきです。</p>

    <p>Windows 95/98 では NET START や NET STOP コマンドを
    サポートしていないので、Command Prompt から Apache のService Control
    オプションを使用しなければなりません。これらのコマンド毎に
    ショートカットを用意し、スタートメニューやデスクトップから
    それをただ請屬海箸派廚米虻遒鮗孫圓垢襪茲Δ砲垢襪里呂茲な，任后鹿霈

腫樵鞜竏と Windows 95/98 は特定のユーザに対して、Apache
    サービスをネットワーク特権では提供しません。実際、Windows 95/98
    はどんなセキュリティもローカルマシンに提供していません。
    Apache Software Fondation がパブリックな httpd サーバとして
    Windows 95/98 の使用を決して認めないのは、これが単純な理由です。
    これらは、web コンテンツの誓遒鞜竏サーバの学習、
    または安全なイントラネット上のサーバ、プライベートネットワークの
    ユーザを補助するために便宜上存在しているにすぎません。</p>
        <hr />

    <h3 align="CENTER">Apache HTTP Server</h3>
    <a href="./"><img src="images/index.gif" alt="Index" /></a>

  </body>
</html>
@


1.1
log
@Initial revision
@
text
@@


1.1.1.1
log
@Import base OpenBSD repository of MirOS ocvs:HEAD
@
text
@@
